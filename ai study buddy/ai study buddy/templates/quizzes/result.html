{% extends "base.html" %}
{% block title %}Achievement Unlocked - AI Smart Buddy{% endblock %}
{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-7 text-center">
            <div class="achievement-card border-0 shadow-lg p-5 rounded-5 bg-white animate-slide-up">
                <div class="celebration-icon mb-4">
                    {% if percentage >= 80 %}
                    <div class="display-1 fw-bold">üèÜ</div>
                    <h2 class="fw-bold text-success animate-bounce">Mastery Achieved!</h2>
                    {% elif percentage >= 50 %}
                    <div class="display-1 fw-bold">‚≠ê</div>
                    <h2 class="fw-bold text-primary">Well Played!</h2>
                    {% else %}
                    <div class="display-1 fw-bold">üìö</div>
                    <h2 class="fw-bold text-warning">Keep Pushing!</h2>
                    {% endif %}
                </div>

                <p class="text-muted fs-5 mb-5">You've completed the <strong>{{ result.quiz.title }}</strong> challenge.
                </p>

                <div class="result-stats bg-light p-4 rounded-4 mb-5 shadow-inner">
                    <div class="row align-items-center">
                        <div class="col-md-6 mb-4 mb-md-0">
                            <div class="score-circle mx-auto level-{{ result.quiz.difficulty }}"
                                style="--percentage: {{ percentage }}%;">
                                <div class="score-inner">
                                    <h1 class="display-4 fw-bold mb-0 text-dark">{{ result.score }}</h1>
                                    <span class="text-muted fw-bold small">OUT OF {{ result.total_points }}</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6 text-start ps-md-4">
                            <div class="mb-3">
                                <label class="text-uppercase small fw-bold text-muted letter-spacing-wide">Mastery
                                    Level</label>
                                <div class="fs-4 fw-bold text-dark">{{ percentage|floatformat:0 }}%</div>
                            </div>
                            <div>
                                <label
                                    class="text-uppercase small fw-bold text-muted letter-spacing-wide">Difficulty</label>
                                <div class="d-flex align-items-center">
                                    <span class="badge rounded-pill bg-{{ result.quiz.difficulty }} px-3 py-2 me-2">
                                        {{ result.quiz.get_difficulty_display }}
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="feedback-section mb-5">
                    {% if percentage >= 100 %}
                    <div class="p-3 rounded-4 bg-success-subtle text-success border border-success">
                        <i class="fas fa-certificate me-2"></i> Perfect score! You've completely mastered this topic.
                        Ready for the next level?
                    </div>
                    {% elif percentage >= 80 %}
                    <div class="p-3 rounded-4 bg-primary-subtle text-primary border border-primary">
                        <i class="fas fa-rocket me-2"></i> Excellent work! You have a strong grasp of these concepts.
                    </div>
                    {% elif percentage >= 50 %}
                    <div class="p-3 rounded-4 bg-info-subtle text-info border border-info">
                        <i class="fas fa-chart-line me-2"></i> Good progress! A bit more practice and you'll reach
                        expert level.
                    </div>
                    {% else %}
                    <div class="p-3 rounded-4 bg-warning-subtle text-warning border border-warning">
                        <i class="fas fa-lightbulb me-2"></i> Don't give up! Review the course material and try again.
                    </div>
                    {% endif %}
                </div>

                <div class="d-grid gap-3">
                    <a href="{% url 'quizzes:quiz_list' %}"
                        class="btn btn-dark btn-lg rounded-pill py-3 fw-bold shadow-sm">
                        Explore Curriculum <i class="fas fa-map-signs ms-2"></i>
                    </a>
                    <a href="{% url 'dashboard' %}" class="btn btn-outline-secondary btn-lg rounded-pill py-3">
                        Return to Dashboard
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .achievement-card {
        border-radius: 40px !important;
        position: relative;
        overflow: hidden;
    }

    .score-circle {
        width: 160px;
        height: 160px;
        border-radius: 50%;
        background: conic-gradient(var(--circle-color) var(--percentage), #e5e7eb 0deg);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 10px;
    }

    .score-inner {
        width: 100%;
        height: 100%;
        background: #fff;
        border-radius: 50%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    .level-beginner {
        --circle-color: #10b981;
    }

    .level-intermediate {
        --circle-color: #3b82f6;
    }

    .level-advanced {
        --circle-color: #ef4444;
    }

    .bg-beginner {
        background: #10b981;
    }

    .bg-intermediate {
        background: #3b82f6;
    }

    .bg-advanced {
        background: #ef4444;
    }

    .shadow-inner {
        box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
    }

    .letter-spacing-wide {
        letter-spacing: 0.1em;
    }

    .animate-bounce {
        animation: bounce 2s infinite;
    }

    @keyframes bounce {

        0%,
        20%,
        50%,
        80%,
        100% {
            transform: translateY(0);
        }

        40% {
            transform: translateY(-10px);
        }

        60% {
            transform: translateY(-5px);
        }
    }

    .animate-slide-up {
        animation: slideUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275) both;
    }

    @keyframes slideUp {
        from {
            opacity: 0;
            transform: translateY(50px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>
{% endblock %}